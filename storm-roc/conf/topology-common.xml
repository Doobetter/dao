<?xml version="1.0" encoding="UTF-8"?>
<topology>
  <properties>
    <property>
      <name>topology.workers</name>
      <value>1</value>
    </property>
    <property>
      <name>topology.acker.executors</name>
      <value>1</value>
    </property>
    <property>
      <name>topology.debug </name>
      <value>false</value>
    </property>
    <property>
      <name>topology.max.spout.pending</name>
      <value>1000</value>
    </property>
    <property>
      <name>topology.message.timeout.secs</name>
      <value>30</value>
    </property>
    <property>
      <name>topology.max.task.parallelism</name>
      <value>50</value>
    </property>
    <property>
      <name>topology.executor.receive.buffer.size</name>
      <value>131072</value>
    </property>
    <property>
      <name>topology.executor.send.buffer.size</name>
      <value>131072</value>
    </property>
    <property>
      <name>topology.receiver.buffer.size</name>
      <value>64</value>
    </property>
    <property>
      <name>topology.transfer.buffer.size</name>
      <value>1024</value>
    </property>
    <property>
      <name>topology.stats.sample.rate</name>
      <value>0.05</value>
    </property>
    <property>
      <name>topology.worker.childopts</name>
      <!--worker.childopts:  -Xms1g -Xmx1g -Xmn378m -XX:SurvivorRatio=2 -XX:+UseConcMarkSweepGC -XX:+UseCMSInitiatingOccupancyOnly -XX:CMSInitiatingOccupancyFraction=65 -->
      <value>-verbose:gc</value>
    </property>
  </properties>
  <components>
    <!--spout can be kafka/text-hdfs/avro-hdfs -->
    <kafka-spout>
      <properties>
        <property>
          <name>spout.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>kafka.topic</name>
          <value>kafa-spout-</value>
        </property>
        <property>
          <name>kafka.zookeeper.hosts</name>
          <value>localhost:2181</value>
        </property>
        <property>
          <name>kafka.zkRoot</name>
          <value>/kafka</value>
        </property>
        <property>
          <name>kafka.isForceFromStart</name>
          <value>false</value>
        </property>
        <property>
          <name>kafka.maxOffsetBehind</name>
          <value>100000000</value>
        </property>
      </properties>
    </kafka-spout>
    <!-- storm-kafka-client use new kafka api -->
    <kafka-client-spout>
      <properties>
        <!-- conf for kafka consumer  -->
        <property>
          <name>bootstrap.servers</name>
          <value>localhost:9093</value>
          <description>A list of kafka server host and port, separated by ','.  Please see 'Socket Server Settings' in 'config/server.properties'  </description>
        </property>
        <property>
          <name>group.id</name>
          <value>topology-kafka-client-spout</value>
          <description>A unique string that identifies the consumer group this consumer belongs to. </description>
        </property>
        
        <property>
          <name>security.protocol</name>
          <value>SSL</value>
        </property>
      </properties>
    </kafka-client-spout>
    
    <text-hdfs-spout>
      <properties>
        <property>
          <name>spout.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>hadoop.conf.path</name>
          <value>/usr/local/share/storm/hadoop-conf</value>
        </property>
        <property>
          <name>hdfs.input.path</name>
          <value>/user/storm/input/</value>
        </property>
        <property>
          <name>hdfs.userName</name>
          <value>storm</value>
        </property>
        <property>
          <name>hdfs.zookeeper.hosts</name>
          <value>localhost:2181</value>
        </property>
        <property>
          <name>hdfs.zkRoot</name>
          <value>/storm/hdfs-spout</value>
        </property>
        <property>
          <name>hdfs.text.delimer</name>
          <value>\001</value>
        </property>
        <property>
          <name>hdfs.zk.commitInterval.tuple</name>
          <value>1000</value>
        </property>
      </properties>
    </text-hdfs-spout>
    <avro-hdfs-spout>
      <properties>
        <property>
          <name>spout.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>hadoop.conf.path</name>
          <value>/usr/local/share/storm/hadoop-conf</value>
        </property>
        <property>
          <name>hdfs.input.path</name>
          <value>/user/storm/input/</value>
        </property>
        <property>
          <name>hdfs.userName</name>
          <value>storm</value>
        </property>
        <property>
          <name>hdfs.zookeeper.hosts</name>
          <value>localhost:2181</value>
        </property>
        <property>
          <name>hdfs.zkRoot</name>
          <value>/storm/hdfs-spout</value>
        </property>
        <property>
          <name>hdfs.avro.schema</name>
          <value>null</value>
        </property>
        <property>
          <name>hdfs.zk.commitInterval.tuple</name>
          <value>1000</value>
        </property>
      </properties>
    </avro-hdfs-spout>
    <!--bolt can be bi/hbase/redis/text-hdfs/avro-hdfs -->
    <customer-bolt>
      <properties>
        <property>
          <name>bolt.executorNumber</name>
          <value>1</value>
        </property>
      </properties>
    </customer-bolt>
    <hbase-bolt>
      <properties>
        <property>
          <name>bolt.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>hbase.writeBufferSize</name>
          <value>1024 * 1024 * 16</value>
        </property>
        <property>
          <name>hbase.tableName</name>
          <value>storm-data</value>
        </property>
        <property>
          <name>hbase.manualFlushLimit</name>
          <value>1000</value>
        </property>
      </properties>
    </hbase-bolt>
    <redis-bolt>
      <properties>
        <property>
          <name>bolt.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>redis.hostAndPort</name>
          <value>localhost:17000</value>
        </property>
      </properties>
    </redis-bolt>
    <text-hdfs-bolt>
      <properties>
        <property>
          <name>bolt.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>hadoop.conf.path</name>
          <value>/usr/local/share/storm/hadoop-conf</value>
        </property>
        <property>
          <name>hdfs.output.path</name>
          <value>/user/storm/output</value>
        </property>
        <property>
          <name>hdfs.userName</name>
          <value>etluser</value>
        </property>
        <property>
          <name>hdfs.output.filename.prefix</name>
          <value>prefix</value>
        </property>
        <property>
          <name>hdfs.sync.interval.tuple</name>
          <value>1000</value>
        </property>
        <property>
          <name>hdfs.tickFreSec</name>
          <value>300</value>
        </property>
        <property>
          <name>hdfs.rotation.fileSize</name>
          <value>256 * 1024 * 1024</value>
        </property>
        <property>
          <name>hdfs.rotation.time.interval</name>
          <value>1000 * 60 * 60 * 1</value>
        </property>
        <property>
          <name>hdfs.text.delimer</name>
          <value>\n</value>
        </property>
      </properties>
    </text-hdfs-bolt>
    <avro-hdfs-bolt>
      <properties>
        <property>
          <name>bolt.executorNumber</name>
          <value>1</value>
        </property>
        <property>
          <name>hadoop.conf.path</name>
          <value>/usr/local/storm/hadoop-conf</value>
        </property>
        <property>
          <name>hdfs.output.path</name>
          <value>/user/storm/output</value>
        </property>
        <property>
          <name>hdfs.userName</name>
          <value>etluser</value>
        </property>
        <property>
          <name>hdfs.output.filename.prefix</name>
          <value>prefix</value>
        </property>
        <property>
          <name>hdfs.sync.interval.tuple</name>
          <value>1000</value>
        </property>
        <property>
          <name>hdfs.tickFreSec</name>
          <value>300</value>
        </property>
        <property>
          <name>hdfs.rotation.fileSize</name>
          <value>256 * 1024 * 1024</value>
        </property>
        <property>
          <name>hdfs.rotation.time.interval</name>
          <value>1000 * 60 * 60 * 1</value>
        </property>
        <property>
          <name>hdfs.avro.schema</name>
          <value>null</value>
        </property>
      </properties>
    </avro-hdfs-bolt>
  </components>
</topology>
